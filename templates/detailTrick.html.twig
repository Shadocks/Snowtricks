{% extends 'base.html.twig' %}

{% block body %}
    <div class="detailTrickPage">

        <div class="container headImageTrick">
            <figure>
            {% for picture in trick.picture|slice(0, 1) %}
                {% if picture.url %}
                    <img class="imageTrickDetailUne" src="{{ picture.url }}">
                    <figcaption><strong>{{ trick.name }}</strong></figcaption>
                {% endif %}
            {% endfor %}
            {% if is_granted('ROLE_USER') %}
                <a type="button" class="btn btn-default editDetailPage" aria-label="Pencil" href="{{ path('trick_update', {'id': trick.id }) }}">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                </a>
                <button type="button" class="btn btn-default deleteDetailPage" aria-label="Trash" data-toggle="modal" data-target="#removeTrickModal">
                    <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                </button>
            {% endif %}
            </figure>
        </div>

        <div class="container mediaLoadMore">
            <div class="visible-xs-block">
                <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#MonCollapse" aria-expanded="false" aria-controls="MonCollapse">Voir médias</button>
            </div>
        </div>

        <section id="MonCollapse" class="collapse hidden-sm hidden-md hidden-lg">
            <div class="well">
            {% if trick.picture|length > 1 %}
                <div class="container listImagesTrick">
                    <div id="myCarouselPictureWell" class="carousel slide" data-ride="carousel">
                        <div class="col-sm-offset-3 col-sm-6">
                            <div class="carousel-inner">
                                {% for picture in trick.picture|slice(0, 1) %}
                                    {% if picture.url %}
                                        <div class="item active">
                                            <img class="imagesTrickDetail" src="{{ picture.url }}">
                                        </div>
                                    {% endif %}
                                {% endfor %}
                                {% for picture in trick.picture|slice(1) %}
                                    {% if picture.url %}
                                        <div class="item">
                                            <img class="imagesTrickDetail" src="{{ picture.url }}">
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                            <a class="left carousel-control" href="#myCarouselPictureWell" data-slide="prev">
                                <span class="glyphicon glyphicon-chevron-left"></span>
                                <span class="sr-only">Previous</span>
                            </a>
                            <a class="right carousel-control" href="#myCarouselPictureWell" data-slide="next">
                                <span class="glyphicon glyphicon-chevron-right"></span>
                                <span class="sr-only">Next</span>
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}

            {% if trick.video|length > 1 %}
                <div class="container listVideosTrick">
                    <div id="myCarouselVideoWell" class="carousel slide" data-ride="carousel">
                        <div class="col-sm-offset-3 col-sm-6">
                            <div class="carousel-inner">
                            {% for video in trick.video|slice(0, 1) %}
                                    <div class="item active">
                                    <iframe src="{{ video.url|urlVideoPlay(video.url) }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                                    </div>
                            {% endfor %}
                            {% for video in trick.video|slice(1) %}
                                    <div class="item">
                                        <iframe src="{{ video.url|urlVideoPlay(video.url) }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                                    </div>
                            {% endfor %}
                            </div>
                            <a class="left carousel-control" href="#myCarouselVideoWell" data-slide="prev">
                                <span class="glyphicon glyphicon-chevron-left"></span>
                                <span class="sr-only">Previous</span>
                            </a>
                            <a class="right carousel-control" href="#myCarouselVideoWell" data-slide="next">
                                <span class="glyphicon glyphicon-chevron-right"></span>
                                <span class="sr-only">Next</span>
                            </a>
                        </div>
                     </div>
                </div>
            {% endif %}

            {% if trick.video|length < 2 %}
                {% for video in trick.video %}
                    <div class="container oneVideoTrick">
                        <div class="col-sm-offset-3 col-sm-6">
                            <iframe width="540" height="300" src="{{ video.url|urlVideoPlay(video.url) }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}

            </div>
        </section>

        {% if trick.picture|length > 1 %}
            <div class="container hidden-xs listImagesTrick">
                <div id="myCarouselPicture" class="carousel slide" data-ride="carousel">
                    <div class="col-sm-offset-3 col-sm-6">
                        <div class="carousel-inner">
                            {% for picture in trick.picture|slice(0, 1) %}
                                {% if picture.url %}
                                    <div class="item active">
                                        <img class="imagesTrickDetail" src="{{ picture.url }}">
                                    </div>
                                {% endif %}
                            {% endfor %}
                            {% for picture in trick.picture|slice(1) %}
                                {% if picture.url %}
                                    <div class="item">
                                        <img class="imagesTrickDetail" src="{{ picture.url }}">
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                        <a class="left carousel-control" href="#myCarouselPicture" data-slide="prev">
                            <span class="glyphicon glyphicon-chevron-left"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="right carousel-control" href="#myCarouselPicture" data-slide="next">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
        {% endif %}

        {% if trick.video|length > 1 %}
            <div class="container hidden-xs listVideosTrick">
                <div id="myCarouselVideo" class="carousel slide" data-ride="carousel">
                    <div class="col-sm-offset-3 col-sm-6">
                        <div class="carousel-inner">
                            {% for video in trick.video|slice(0, 1) %}
                                <div class="item active">
                                    <iframe src="{{ video.url|urlVideoPlay(video.url) }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                                </div>
                            {% endfor %}
                            {% for video in trick.video|slice(1) %}
                                <div class="item">
                                    <iframe src="{{ video.url|urlVideoPlay(video.url) }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                                </div>
                            {% endfor %}
                        </div>
                        <a class="left carousel-control" href="#myCarouselVideo" data-slide="prev">
                            <span class="glyphicon glyphicon-chevron-left"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="right carousel-control" href="#myCarouselVideo" data-slide="next">
                            <span class="glyphicon glyphicon-chevron-right"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
        {% endif %}

        {% if trick.video|length < 2 %}
            {% for video in trick.video %}
                <div class="container hidden-xs oneVideoTrick">
                    <div class="col-sm-offset-3 col-sm-6">
                        <iframe width="540" height="300" src="{{ video.url|urlVideoPlay(video.url) }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                    </div>
                </div>
            {% endfor %}
        {% endif %}

        <div class="container descriptionTrick">
            <p>{{ trick.description }}</p>
        </div>

        <div class="container infoTrick">
            <p>
                <span class="label label-info">Créé le {{ trick.creationDate|localizeddate('full', 'none', null, null, 'dd MMMM Y à H:mm') }}</span>
                <span class="label label-info">Catégorie : {{ trick.category }}</span>
                {% if trick.modificationDate %}
                    <span class="label label-info">Modifié le {{ trick.modificationDate|localizeddate('full', 'none', null, null, 'dd MMMM Y à H:mm') }}</span>
                {% endif %}
            </p>
        </div>

        <div class="modal fade" id="removeTrickModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">Suppression</h4>
                    </div>
                    <div class="modal-body">
                        Êtes-vous sûr de vouloir supprimer {{ trick.name }} ?
                    </div>
                    <div class="modal-footer">
                        <a class="btn btn-danger" href="{{ path('trick_delete', {'id': trick.id }) }}">Oui</a>
                        <a class="btn btn-primary" data-dismiss="modal">Non</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="container commentForm">
            {% if is_granted('ROLE_USER') %}
            <h3>Laisser un commentaire</h3>
                {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}
                <div class="form-group">
                    <div class="col-xs-12">
                    {{ form_label(form.content, 'Message', {'label_attr': {'class': 'col-sm-2 control-label'}}) }}
                        <div class="col-sm-10">
                            {{ form_widget(form.content, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    </div>
                </div>
                <div class="btn-add-comment">
                    <button type="submit" class="btn btn-primary btnCommentSubmit">Poster</button>
                {{ form_end(form) }}
                </div>
            {% endif %}
        </div>

        {% if trick.comment|length > 0 %}
            <div class="container commentList">
                <h3>Commentaires</h3>
                    {% for comment in trick.comment|reverse %}
                        <div class="media comment">
                            <div class="media-left">
                                <img src="{{ comment.user.picture.url }}" class="media-object" style="width: 70px">
                            </div>
                            <div class="media-body">
                                <h4 class="media-heading">{{ comment.user.username }}</h4>
                                <p><i>Posté le {{ comment.creationDate|localizeddate('full', 'none', null, null, 'EEEE dd MMMM Y à H:mm') }}</i></p>
                                <p>{{ comment.content }}</p>
                            </div>
                        </div>
                    {% endfor %}
            </div>
        {% endif %}

        {% if trick.comment|length > 4 %}
            <div class="wrap-button">
                <button href="#" id="loadMore" class="btn btn-primary">Voir plus</button>
            </div>
        {% endif %}

    </div>
{% endblock %}

{% block javascripts %}
    <script src="/js/detailsTrick.js" type="text/javascript"></script>
{% endblock %}
